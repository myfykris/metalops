============================================================
METALOPS UNIFIED BENCHMARK
============================================================

Benchmarking SVD...
  Tiny: 15.46x
  Small square: 4.28x
  Medium square: 2.07x
  Large square: 1.29x
  Very large: 0.78x
  Huge square: 0.76x
  Massive square: 0.72x
  Tall 2:1: 1.35x
  Tall 2:1 large: 0.89x
  Tall matrix: 0.39x
  Very tall: 0.14x
  Wide 1:2: 1.24x
  Llama-7B attn (4096x4096): 0.58x
  Llama-2-7B MLP (4096x11008): 0.25x
  Llama-3-8B MLP (4096x14336): 0.18x
  Llama-70B attn (8192x8192): 0.57x
  Mistral-7B MLP (4096x14336): 0.18x
  Qwen-7B MLP (4096x11008): 0.25x
  Gemma-7B MLP (3072x24576): 0.04x
  Phi-3-mini MLP (3072x8192): 0.18x
  Batch 100 tiny: 0.84x
  Batch 50 small: 0.53x
  Batch 100 small: 0.39x
  Batch 200 small: 0.30x
  Batch 20 medium: 0.40x
  Batch 50 medium: 0.26x
  Batch 10 large: 1.10x
  Batch 5 huge: 0.69x
Benchmarking QR (single matrix)...
  Tiny: 35.56x
  Small 32: 25.78x
  Small 64: 39.12x
  Medium: 28.29x
  Large 256: 12.85x
  Large 512: 7.94x
  Huge 1024: 3.21x
  Tall 4:1: 18.59x
  Tall 2:1: 14.89x
  Tall 4:1 large: 7.97x
  Tall 2:1 large: 9.37x
  Tall 5:1: 7.40x
  Huge tall: 5.06x
  Massive: 3.93x
Benchmarking QR (batched)...
  Tiny 8x8: 0.22x
  Batch 100 tiny: 0.15x
  Batch 500 tiny: 0.03x
  ML mini-batch 16: 0.37x
  Batch 100 16x16: 0.21x
  Batch 200 16x16: 0.12x
  Batch 500 16x16: 0.12x
  Batch 1000 16x16: 0.07x
  ML mini-batch 32: 0.91x
  Batch 100 32x32: 0.44x
  Batch 200 32x32: 0.27x
  Batch 500 32x32: 0.22x
  Batch 50 48x48: 1.55x
  Batch 100 48x48: 0.78x
  Tall batch: 0.45x
  Wide batch: 0.67x
  Large tall batch: 0.37x
Benchmarking CHOLESKY...
  Tiny batched: 0.07x
  Large batch tiny: 0.03x
  Small batched: 0.11x
  Medium batched: 0.08x
  Larger batched: 0.21x
Benchmarking SOLVE...
  Tiny batched: 1.59x
  Large batch tiny: 0.40x
  Small batched: 2.06x
  Medium batched: 2.31x
Benchmarking EIGH...
  Tiny: 18.20x
  Small: 4.11x
  Medium: 2.01x
  Large: 1.44x
  Very large: 1.22x
  Huge: 1.03x
  Batch 100 tiny: 1.31x
  Batch 50 small: 0.60x
  Batch 100 small: 0.45x
  Batch 200 small: 0.40x
  Batch 20 medium: 0.44x
  Batch 50 medium: 0.33x
  Batch 10 large: 1.08x
Benchmarking Pipeline Operations...
  Pipeline: QR -> QR -> QR (batched)
    QR x3: 0.29x
  Pipeline: SVD batched (PCA)
Traceback (most recent call last):
  File "/Users/kris/localprojects/metalops/benchmark.py", line 1089, in <module>
    main()
    ~~~~^^
  File "/Users/kris/localprojects/metalops/benchmark.py", line 1027, in main
    pipeline_results = benchmark_pipeline()
  File "/Users/kris/localprojects/metalops/benchmark.py", line 836, in benchmark_pipeline
    U, S, V = metalcore.svd(A_gpu)
              ^^^^^^^^^
NameError: name 'metalcore' is not defined
Loaded metalcore kernels from file: /Users/kris/localprojects/metalops/packages/metalcore/native/core_kernels.metal
metalcore: Loaded 16 kernel functions
